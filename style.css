
/* --- Editor Button --- */
#editorBtn {
  position: absolute;
  top: 10px;
  right: 60px;
  background: none;
  border: none;
  font-size: 1.5rem;
  cursor: pointer;
  opacity: 0.5;
  z-index: 50;
}
#editorBtn:hover { opacity: 1; }

/* --- Editor Overlay & Components --- */
.editor-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(2px);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 3000;
}
.editor-overlay.open { display: flex; }
.editor-box {
  background: #111;
  border: 1px solid #333;
  width: 90%;
  height: 85%;
  border-radius: 12px;
  display: flex;
  flex-direction: column;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
}
.editor-title-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 15px;
  border-bottom: 1px solid #333;
  color: white;
  font-size: 18px;
}
.editor-close {
  background: none;
  border: none;
  color: #aaa;
  cursor: pointer;
  font-size: 20px;
}
.editor-close:hover { color: #fff; }
.editor-toolbar {
  display: flex;
  gap: 10px;
  padding: 10px 15px;
  border-bottom: 1px solid #333;
}
.editor-toolbar button {
  background: #222;
  color: #ccc;
  border: 1px solid #444;
  padding: 6px 10px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 12px;
}
.editor-toolbar button:hover {
  background: #333;
  color: #fff;
}
.tab-bar {
  display: flex;
  overflow-x: auto;
  border-bottom: 1px solid #333;
}
.tab-bar .tab-button {
  padding: 10px 15px;
  cursor: pointer;
  background: #111;
  border: none;
  color: #aaa;
  border-right: 1px solid #333;
  font-size: 14px;
  white-space: nowrap;
  display: flex;
  align-items: center;
  gap: 6px;
}
.tab-bar .tab-button.active {
  background: #222;
  color: white;
}

/* Close button for file tabs */
.tab-close {
  font-size: 12px;
  margin-left: 4px;
  color: #666;
  cursor: pointer;
  display: inline-block;
}
.tab-close:hover {
  color: #ccc;
}
.panes-wrapper {
  flex: 1;
  position: relative;
}
.editor-pane {
  position: absolute;
  inset: 0;
  display: none;
  width: 100%;
  height: 100%;
}
.editor-pane.active {
  display: block;
}
#consoleOutput {
  white-space: pre-wrap;
}

/* Editor wrapper for custom code editors with line numbers */
.editor-wrapper {
  display: flex;
  height: 100%;
  width: 100%;
  overflow: hidden;
}
.line-numbers {
  width: 40px;
  background: #0d1117;
  color: #888;
  padding: 10px 5px;
  font-family: 'JetBrains Mono', monospace;
  font-size: 14px;
  line-height: 1.4;
  user-select: none;
  overflow: hidden;
  /* Display numbers vertically and align to the right */
  display: flex;
  flex-direction: column;
  align-items: flex-end;
}

/* Each line number on its own row */
.line-numbers div {
  height: 1.4em;
  line-height: 1.4em;
}
.code-area {
  flex: 1;
  background: #0d1117;
  color: #f0f0f0;
  border: none;
  padding: 10px;
  font-family: 'JetBrains Mono', monospace;
  font-size: 14px;
  line-height: 1.4;
  resize: none;
  overflow: auto;
  border-left: 1px solid #333;
}
.code-area:focus {
  outline: none;
}
/* --- 1. VARIABLES & THEME (DeepSeek Style) --- */
:root {
  --bg-app: #0a0a0a;       
  --bg-sidebar: #000000;   
  --bg-panel: #161616;     
  --bg-input: #1a1a1a;     
  --border: #333333;       
  
  --primary: #4d6bfe;      
  --accent: #2ea043;       
  --danger: #da3633;       
  
  --text-main: #ededed;
  --text-dim: #888888;
  --radius: 8px;
}

* { box-sizing: border-box; outline: none; }
body {
  font-family: 'Inter', system-ui, -apple-system, sans-serif;
  background: var(--bg-app);
  color: var(--text-main);
  margin: 0; padding: 0;
  height: 100vh;
  display: flex;
  overflow: hidden;
}

/* --- 2. LAYOUT --- */
.app-layout { display: flex; width: 100%; height: 100%; }

/* Sidebar */
.sidebar {
  width: 260px;
  background: var(--bg-sidebar);
  border-right: 1px solid var(--border);
  display: flex; flex-direction: column;
  padding: 12px;
  flex-shrink: 0;
  z-index: 100;
}
.new-chat-btn {
  width: 100%; background: var(--bg-panel); color: var(--text-main); border: 1px solid var(--border);
  padding: 12px; border-radius: var(--radius); cursor: pointer; font-weight: 500;
  transition: 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px;
}
.new-chat-btn:hover { background: #222; border-color: var(--text-dim); }

.history-list { flex: 1; overflow-y: auto; margin-top: 15px; display: flex; flex-direction: column; gap: 4px; }

.chat-item {
  display: flex; align-items: center; justify-content: space-between;
  padding: 10px; border-radius: 6px; cursor: pointer; color: var(--text-dim); font-size: 0.9rem;
  transition: 0.1s; user-select: none;
}
.chat-item:hover { background: #1a1a1a; color: var(--text-main); }
.chat-item.active { background: #222; color: white; border: 1px solid var(--border); }
.chat-title { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 180px; }
.del-btn { opacity: 0; background: none; border: none; color: var(--danger); cursor: pointer; padding: 4px; }
.chat-item:hover .del-btn { opacity: 1; }

/* Main Content */
.main-content { flex: 1; display: flex; flex-direction: column; min-width: 0; position: relative; }

/* Chat Area */
#chat { 
  flex: 1; overflow-y: auto; padding: 20px 10%; 
  display: flex; flex-direction: column; gap: 24px; scroll-behavior: smooth;
}

/* Messages */
.msg { max-width: 100%; line-height: 1.6; font-size: 15px; word-wrap: break-word; position: relative; }
.me { align-self: flex-end; max-width: 85%; background: #202020; padding: 12px 18px; border-radius: 12px; border: 1px solid #333; }
.bot { align-self: flex-start; max-width: 95%; width: 100%; padding: 0 10px; } 
.sys { align-self: center; font-size: 13px; color: var(--text-dim); background: #111; padding: 6px 12px; border-radius: 20px; border: 1px dashed #333; margin: 10px 0; text-align: center; }

/* --- ACTIONS (Edit/Delete) --- */
.msg-actions {
  position: absolute; top: -12px; right: 0;
  background: #222; border: 1px solid #444; border-radius: 6px;
  display: none; gap: 2px; padding: 2px; z-index: 10;
}
.msg:hover .msg-actions { display: flex; }
.act-btn {
  background: transparent; border: none; color: #888; cursor: pointer;
  padding: 4px 6px; font-size: 12px; border-radius: 4px;
}
.act-btn:hover { background: #333; color: white; }
.act-btn.del:hover { color: var(--danger); }

/* Edit Textarea */
.edit-textarea {
  width: 100%; background: #111; color: #ddd; border: 1px solid #444;
  padding: 8px; border-radius: 6px; resize: vertical; min-height: 60px;
  font-family: inherit; margin-top: 5px; font-size: 14px;
}

/* --- 3. MARKDOWN STYLES --- */
.msg strong { color: #fff; font-weight: 600; }
.msg em { font-style: italic; color: #aaa; }
.msg u { text-decoration: underline; text-underline-offset: 4px; }
.msg s { text-decoration: line-through; opacity: 0.6; }
.msg table { width: auto; min-width: 50%; border-collapse: collapse; margin: 16px 0; border: 1px solid #30363d; font-size: 14px; }
.msg th { background: #161b22; text-align: left; font-weight: 600; color: var(--text-main); padding: 8px 12px; border: 1px solid #30363d; }
.msg td { border: 1px solid #30363d; padding: 8px 12px; background: #0d1117; }
.msg pre { background: #0d1117; border: 1px solid #30363d; border-radius: 8px; margin: 16px 0; overflow-x: auto; }
.code-header { display: flex; justify-content: space-between; align-items: center; background: #161b22; padding: 6px 12px; border-bottom: 1px solid #30363d; font-family: sans-serif; font-size: 12px; color: #8b949e; }
.msg code { font-family: 'JetBrains Mono', monospace; font-size: 13px; tab-size: 2; }
.msg pre code { display: block; padding: 12px; color: #e6edf3; overflow-x: auto; }
.msg p > code { background: rgba(110,118,129,0.4); padding: 2px 5px; border-radius: 4px; font-size: 0.9em; color: #e6edf3; }

/* --- 4. INPUT AREA --- */
.input-area { background: var(--bg-app); border-top: 1px solid var(--border); padding: 0 10% 20px 10%; display: flex; flex-direction: column; gap: 0; }
#tools-panel { display: flex; gap: 15px; padding: 8px 0; font-size: 12px; color: var(--text-dim); }
#tools-panel label { cursor: pointer; display: flex; align-items: center; gap: 6px; user-select: none; transition: 0.2s;}
#tools-panel label:hover { color: var(--text-main); }
#tools-panel input[type="checkbox"] { accent-color: var(--primary); }
.input-box-wrapper { background: var(--bg-input); border: 1px solid var(--border); border-radius: 12px; padding: 10px; display: flex; flex-direction: column; transition: border 0.2s; }
.input-box-wrapper:focus-within { border-color: var(--text-dim); }
#previewContainer { display: none; background: #222; padding: 6px 10px; margin-bottom: 8px; border-radius: 6px; font-size: 12px; color: var(--accent); }
.file-row { display: flex; align-items: center; justify-content: space-between; }
.input-row { display: flex; align-items: flex-end; gap: 10px; }
#fileBtn { font-size: 1.2rem; cursor: pointer; color: var(--text-dim); padding: 5px; background: none; border: none; }
#fileBtn:hover { color: var(--text-main); }
#text { flex: 1; background: transparent; border: none; color: white; font-family: inherit; font-size: 16px; padding: 8px 0; resize: none; max-height: 200px; }
#sendBtn { background: var(--primary); color: white; border: none; border-radius: 8px; width: 36px; height: 36px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: 0.2s; }
#sendBtn:hover { opacity: 0.9; }
#sendBtn:disabled { background: #333; cursor: not-allowed; }

/* --- 5. SETTINGS MODAL --- */
.settings-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(2px); display: none; align-items: center; justify-content: center; z-index: 2000; }
.settings-overlay.open { display: flex; }
.settings-box { background: #111; border: 1px solid #333; width: 400px; padding: 25px; border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
.st-input { width: 100%; background: #222; border: 1px solid #333; color: white; padding: 10px; border-radius: 6px; margin: 5px 0 15px 0; }
.btn-row { display: flex; gap: 10px; margin-top: 10px; }
.btn-save { flex: 1; background: var(--primary); color: white; border: none; padding: 10px; border-radius: 6px; cursor: pointer; }
.btn-cancel { flex: 1; background: #222; color: #aaa; border: 1px solid #333; padding: 10px; border-radius: 6px; cursor: pointer; }
.btn-mem { width: 100%; background: transparent; border: 1px dashed #444; color: #666; padding: 8px; font-size: 12px; margin-top: 15px; cursor: pointer; }
.custom-model-row { display: flex; gap: 8px; margin-top: 5px; }
.custom-model-row input { flex: 1; }

/* Loader */
.typing-dot { display: inline-block; width: 4px; height: 4px; background: #aaa; border-radius: 50%; animation: type 1.4s infinite; margin: 0 1px; }
.typing-dot:nth-child(2) { animation-delay: 0.2s; }
.typing-dot:nth-child(3) { animation-delay: 0.4s; }
@keyframes type { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-4px); } }

/* Mobile */
@media(max-width: 768px) {
  .sidebar { position: absolute; height: 100%; transform: translateX(-100%); transition: transform 0.3s; }
  .sidebar.open { transform: translateX(0); }
  #chat, .input-area { padding-left: 15px; padding-right: 15px; }
  .mobile-menu { display: block; position: absolute; top: 10px; left: 10px; z-index: 50; background: #000; border: 1px solid #333; color: white; padding: 5px 10px; border-radius: 4px;
}